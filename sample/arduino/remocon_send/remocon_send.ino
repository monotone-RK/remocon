#define IR_OUTPIN 2
#define LEDPIN    8
 
// air-con on（danbou, 23, sizuka）
unsigned int data[] = {49,41,36,49,37,49,37,48,37,48,46,2525,354,164,40,132,49,41,45,41,36,49,37,132,48,37,48,41,37,49,36,49,37,132,40,49,37,132,40,135,38,49,37,132,41,132,41,132,40,132,40,135,38,49,37,48,37,136,45,40,37,49,37,49,36,49,37,48,37,48,37,50,36,49,37,49,37,49,36,132,40,49,37,132,41,49,37,49,37,49,36,132,40,135,46,40,37,48,37,49,37,48,38,48,37,48,37,49,45,40,37,48,38,48,37,49,37,49,37,49,36,49,37,132,40,49,38,132,48,124,40,132,40,49,37,132,41,46,48,40,37,49,36,3467,346,171,43,132,40,49,37,48,37,49,37,132,40,49,37,49,37,49,37,49,37,132,40,49,37,132,41,135,37,49,37,132,41,132,42,130,41,132,40,132,40,49,37,49,37,135,37,49,37,49,37,49,36,49,37,49,36,49,37,48,37,49,45,40,37,48,38,49,37,132,43,47,37,48,37,49,37,48,38,135,37,49,37,49,37,49,36,49,37,49,36,49,37,49,37,49,37,49,37,48,37,49,37,49,36,49,37,48,37,48,37,50,37,48,37,49,37,49,37,132,41,49,37,132,41,49,37,136,37,49,37,3467,355,164,43,130,43,47,37,49,37,49,45,123,43,47,45,41,46,40,37,49,36,132,40,49,37,132,40,132,40,49,45,124,48,123,41,132,41,135,37,132,40,49,46,40,45,125,39,49,37,49,36,50,36,49,37,49,46,40,37,49,36,49,37,49,37,48,37,49,46,40,37,49,37,46,48,37,40,51,43,41,37,49,36,132,49,40,37,49,37,132,40,49,46,41,37,135,37,49,37,49,37,132,40,135,38,135,38,48,37,133,40,49,37,48,37,49,45,41,37,51,34,49,36,49,37,49,36,49,37,49,37,49,37,48,38,49,36,49,46,127,37,132,40,49,46,123,41,49,37,48,37,49,37,49,37,49,37,48,37,49,37,49,36,49,37,49,37,49,37,49,37,48,37,48,38,48,37,49,37,49,36,49,37,49,45,40,37,49,45,40,37,49,37,49,37,49,36,49,37,48,37,49,37,45,40,49,45,40,37,49,37,48,37,49,37,49,36,49,37,49,37,49,37,49,37,49,36,49,37,48,37,49,37,49,36,49,37,49,36,49,37,49,37,49,37,49,37,48,37,48,37,50,36,49,37,132,40,132,40,49,37,49,36,49,37,49,36,49,37,49,36,49,37,48,38,49,36,49,37,49,37,49,37,48,37,49,37,46,40,49,37,132,40,49,37,49,37,132,40,132,41,132,40,132,41,132,41};

// air-con off
//unsigned int data[] = {40,45,40,48,37,50,36,49,37,49,37,2533,346,173,40,132,40,49,37,49,37,48,38,132,40,49,37,45,40,49,36,50,36,132,40,49,37,132,40,132,40,46,40,132,40,132,41,135,37,132,41,132,40,49,37,48,37,132,40,46,40,46,40,45,41,48,37,49,37,48,38,48,37,46,40,48,37,48,38,132,40,49,37,131,41,49,37,49,37,48,37,132,40,132,41,49,37,49,36,49,37,49,37,49,37,49,37,49,36,48,38,49,36,49,37,49,37,49,36,49,37,48,37,132,40,49,36,132,40,136,37,132,40,49,37,132,40,49,37,49,37,49,36,3467,346,172,49,124,40,46,40,46,40,52,35,135,37,48,37,48,38,48,37,49,37,132,43,46,37,132,40,136,37,49,37,132,49,124,49,126,37,132,41,132,40,49,37,49,36,132,51,39,45,40,37,49,37,49,45,41,37,50,36,49,37,49,36,48,46,40,38,49,37,135,37,49,37,49,36,49,37,48,37,132,41,45,41,48,37,49,37,48,38,49,45,41,37,48,37,48,38,45,41,49,45,40,38,49,37,48,37,50,36,49,36,49,37,49,36,49,37,49,37,135,37,49,37,132,40,49,37,132,40,49,37,3466,355,164,41,136,37,49,37,49,37,49,45,124,40,49,37,48,37,49,45,40,38,132,40,49,45,124,41,132,40,49,37,136,37,136,37,135,38,135,37,135,37,49,37,49,36,132,49,40,37,49,37,49,37,49,37,49,36,49,37,48,37,48,37,49,37,49,37,49,45,37,40,49,36,49,37,49,37,49,37,49,37,49,37,50,36,49,36,49,37,132,40,49,37,49,37,132,40,49,37,52,36,133,37,132,40,132,41,49,37,132,40,49,37,48,37,49,37,49,37,49,37,49,37,49,36,49,36,49,37,49,36,48,38,49,37,49,37,49,36,132,40,132,41,49,37,132,41,49,37,49,37,49,36,49,37,48,38,48,37,49,37,49,36,49,37,49,36,49,37,49,37,48,37,49,37,48,38,49,37,49,36,49,37,49,37,48,37,49,37,49,37,49,37,49,36,49,37,49,36,49,36,50,36,49,37,48,38,49,36,49,37,49,36,49,37,49,36,49,37,49,37,48,37,49,37,48,37,49,37,49,36,49,37,49,37,49,37,49,37,48,38,49,37,49,36,49,37,49,36,49,37,49,37,48,37,132,40,132,40,49,37,49,36,49,37,49,37,49,37,49,37,46,40,49,37,48,37,48,38,48,37,49,37,48,37,49,37,46,40,49,37,49,37,48,37,49,37,132,40,132,40,132,40,132,40,132,40};

// TV on/off
//unsigned int data[] = {346,160,41,46,38,125,42,42,50,120,38,45,38,125,50,37,38,126,50,37,38,126,50,37,38,125,42,126,50,34,41,125,42,42,50,116,42,125,50,116,42,126,41,46,38,42,42,46,38,125,50,37,38,125,50,37,38,46,38,125,51,37,38,46,47,38,38,45,38,125,50,118,49,34,50,117,50,37,46,34,50,37,38,125,50,37,38,45,48,36,38,125,42,46,38,125,50,117,41,7033,336,169,42,46,38,125,42,43,49,117,50,37,38,126,50,37,38,125,50,37,47,116,42,46,46,116,42,126,42,42,50,116,42,46,38,125,50,116,42,126,50,117,50,37,38,42,51,37,38,126,41,46,46,117,41,42,50,37,46,116,42,45,39,48,44,36,50,34,50,116,50,117,42,42,42,126,49,34,41,42,51,37,38,125,42,46,38,46,38,45,46,117,42,46,46,117,42,125,50};
// -- 4ch
// -- unsigned int data[] = {339,166,39,46,38,128,41,43,39,128,38,45,41,126,39,45,39,128,39,46,38,128,39,45,47,120,39,128,39,45,44,123,39,46,44,123,43,123,39,128,44,123,44,40,44,40,44,40,44,123,44,40,43,122,44,40,43,40,44,123,44,40,43,40,44,43,42,123,44,40,44,40,43,40,43,123,44,40,43,123,44,40,44,40,44,123,44,40,44,40,43,123,44,40,44,122,44,123,44,7031,335,170,38,46,40,126,41,43,49,118,39,45,39,128,40,43,38,128,39,46,41,125,39,45,39,128,39,128,39,45,39,128,39,45,38,128,39,128,39,128,41,126,42,43,38,45,39,45,39,128,39,45,39,128,38,45,39,45,39,128,39,45,38,45,38,47,39,128,41,43,38,45,39,45,40,128,39,45,38,128,41,43,39,45,39,128,38,45,39,45,39,128,41,42,39,128,41,126,41};

void setup() {
  pinMode(IR_OUTPIN, OUTPUT);
  pinMode(LEDPIN, OUTPUT);
}
 
// send a signal from data
void sendSignal() {
  int dataSize = sizeof(data) / sizeof(data[0]);
  for (int cnt = 0; cnt < dataSize; cnt++) {
    unsigned long transmittion_time = data[cnt] * 10;  // per us
    unsigned long send_start = micros();
    /* ----- IR Signal Core begin ----- */
    do {
      /* control timing for generating 38KHz carrier frequency (29~32 line) */
      digitalWrite(IR_OUTPIN, 1 - (cnt&1));  // If cnt is even, IR_OUT is ON. If not, IR_OUT is OFF
      delayMicroseconds(8);                  
      digitalWrite(IR_OUTPIN, 0);            
      delayMicroseconds(7);
    } while (long(micros() - send_start) < transmittion_time);  // send IR signal by transmittion time
    /* ----- IR Signal Core end   ----- */
  }
}
 
void loop() {
  digitalWrite(LEDPIN, HIGH);
  sendSignal();
  digitalWrite(LEDPIN, LOW);
  delay(3000);
}
